<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Borz Marketing Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    {% if session.get('user') %}
    <script src="{{ url_for('static', filename='tab_enforcement.js') }}"></script>
    {% endif %}
    <style>
        /* Dynamic fade duration from config */
        .hero-title {
            transition: opacity {{ slideshow_fade_duration }}ms ease !important;
        }
    </style>
</head>
<body>
    <div class="panel">
        <nav class="navbar">
            <div class="navbar-content">
                <div class="navbar-left">
                    <div class="menu-icon" id="menu-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </div>
                    <div class="navbar-text">
                        <h1 class="navbar-title">Borz Marketing Panel</h1>
                        <p class="navbar-subtitle">Welcome to your marketing automation hub</p>
                    </div>
                </div>
                <div class="nav-right">
                    {% if session.get('user') %}
                        <div class="user-info">
                            {% if session['user'].avatar %}
                                <img src="https://cdn.discordapp.com/avatars/{{ session['user'].id }}/{{ session['user'].avatar }}.png" alt="{{ session['user'].username }}" class="user-avatar">
                            {% else %}
                                <div class="user-avatar-placeholder">{{ session['user'].username[0].upper() }}</div>
                            {% endif %}
                            <div class="user-details">
                                <div class="username">{{ session['user'].username }}</div>
                                <div class="user-id">{{ session['user'].id }}</div>
                            </div>
                        </div>
                    {% else %}
                        <div class="auth-buttons">
                            <a href="{{ url_for('login_page') }}" class="auth-btn login-btn">Login</a>
                            <a href="{{ url_for('signup_page') }}" class="auth-btn signup-btn">Sign Up</a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Dropdown Menu -->
            <div class="dropdown-menu" id="dropdown-menu">
                <a href="{{ url_for('home') }}" class="dropdown-item">Home</a>
                <a href="{{ url_for('purchase') }}" class="dropdown-item">Purchase</a>
                {% if session.get('user') %}
                    {% if plan_status and plan_status.has_plan %}
                        <a href="{{ url_for('panel') }}" class="dropdown-item">Panel</a>
                    {% endif %}
                    {% if has_business %}
                    <a href="{{ url_for('business_management') }}" class="dropdown-item">Business Management</a>
                    <a href="{{ url_for('business_panel') }}" class="dropdown-item">Business Panel</a>
                    {% endif %}
                    <a href="{{ url_for('settings') }}" class="dropdown-item">Settings</a>
                {% endif %}
                <div class="dropdown-divider"></div>
                <a href="https://discord.gg/KWt6rvCukp" target="_blank" class="dropdown-item discord-item">Discord Server</a>
                {% if session.get('user') %}
                    <a href="{{ url_for('logout') }}" class="dropdown-item logout-item">Logout</a>
                {% endif %}
            </div>
        </nav>

        <div class="panel-container">
            <div class="home-content">
                <div class="hero-section">
                    <h2 class="hero-title" id="hero-title">{{ slideshow_messages[0] }}</h2>
                    <a href="{{ url_for('purchase') }}" class="view-pricing-btn">View Pricing</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dropdown menu toggle
        const menuIcon = document.getElementById('menu-icon');
        const dropdownMenu = document.getElementById('dropdown-menu');

        if (menuIcon) {
            menuIcon.addEventListener('click', (e) => {
                e.stopPropagation();
                dropdownMenu.classList.toggle('show');
            });
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!dropdownMenu.contains(e.target) && !menuIcon.contains(e.target)) {
                dropdownMenu.classList.remove('show');
            }
        });

        // Hero text slideshow
        const heroTitle = document.getElementById('hero-title');
        const messages = {{ slideshow_messages | tojson }};
        const interval = {{ slideshow_interval }};
        const fadeDuration = {{ slideshow_fade_duration }};
        let currentIndex = 0;

        function changeSlide() {
            // Fade out
            heroTitle.classList.add('fade-out');

            setTimeout(() => {
                // Change text
                currentIndex = (currentIndex + 1) % messages.length;
                heroTitle.textContent = messages[currentIndex];

                // Fade in
                heroTitle.classList.remove('fade-out');
                heroTitle.classList.add('fade-in');

                setTimeout(() => {
                    heroTitle.classList.remove('fade-in');
                }, fadeDuration);
            }, fadeDuration);
        }

        // Start slideshow
        setInterval(changeSlide, interval);
    </script>
</body>
</html>
